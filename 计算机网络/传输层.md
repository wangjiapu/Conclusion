

# 传输层

概述：  传输层是建立数据传送通道的作用，当然，数据链路层也是这么一个功能，不同指出在于：数据链路层是主要在局域网中建立数据通道
但是，传输层是在广域网中建立传输通道。

### 划分传输层的必要性：


传输层即使面向通信不=部分的最高层，又是面向用户部分的最底层，仅仅依靠网络层的协议将数据传送到对应的主机是不行的，
需要输送到对应的应用进程中。

而且，下三层不具有数据控制的的作用。这里说的数据控制是：广域网。由于广域网中的数据没办法使用数据链路层来控制所以就体现了
传输层的端对端的传输的必要性。

### 端对端，点对点：

端：两个终端；（也就是l两个电脑，中间至少有一个或者多个路由器的中转）

点：两个路由器，中间是有电缆连接的 ，没有任何其他设备。这就是点对点

###  传输层服务：

#### 服务类型：
- 面向连接
- 面向无连接

#### 服务等级：

不同类型的网络，以及不同连接性能的网络，所提供饿传输层服务类别也是不同的，


两个服务：：
- 传输连接：它上层的每一个应用进程在网络层提供服务的基础之上建立一个相应的逻辑接口
- 数据传输：在建立的连接基础之上，为用户提供一个比网络层更有保障，更有针对性，并且能够为用户自己进行拥塞控制，擦错控制的数据传输。

服务水平分为三大类：

- A类：低的连接差错率和故障率，是可靠的传输服务，一般指的是虚电路网络
- B类：具有较低的差错率和故障率，传输服务质量中等，应用于广域网和互联网中传输层协议多数属于这一类
- C类：较高的事故几率，

#### 传输层协议类别：

TP0~TP4五种类型

TP0~TP3属于面向连接型的传输层协议，发送数据包之前必须要建立连接。
TP4是既可以是面向连接的传输层协议，也可以是无连接的传输层协议；

- TP0:简单类，提供数据段的分包和重组功能
- TP1:TP0+差错控制（对每一个TPDU进行编号，当收到不确定的消息，或者TPDU丢失的时候会重新发送；
    如果差错太多，那么就直接重新初始化传输连接）
- TP2：TP0+多路复用+解复用+流量控制
- TP3:TP1+TP2
- TP4: TP3+差错检测功能


### TSAP和TPDU

#### TSAP:传输服务访问点。

我们可以知道：不同层之间的互相访问时通过SAP(服务访问点),sap位于除了最高层之外的每一层的上边缘，是用来为下层向上提供服务的，
同样是上层调用下层的一个逻辑接口


#### TPDU：传输协议数据单元。

说白了也就是：OSI/RM体系中的数据段。有他独有的格式，用来完成三次握手和四次握手。

在OSI/RM体系中是一个特别重要的概念：基本结构是：TPDU头部+有效载荷

![TPDU数据段图](https://github.com/wangjiapu/Conclusion/blob/master/imge/WechatIMG13.jpeg)

头部包括：

- L1:一个字节表示整个头部的长度，最大值是254
- 固定部分：TPDU代码和常用参数
- 可变参数：**可选**参数项；


具体如下图：
##### 参数表：
![参数表](https://github.com/wangjiapu/Conclusion/blob/master/imge/WechatIMG14.jpeg)


##### 建立的TPDU数据段解析：

![连接数据段](https://github.com/wangjiapu/Conclusion/blob/master/imge/WechatIMG15.jpeg)



### [TCP](https://github.com/wangjiapu/Conclusion/blob/master/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCP.md)





