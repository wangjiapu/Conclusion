


# 网络层

## ip协议：了解ip协议前先了解ip数据包的结构

[ip数据包结构]()

通过上图可以清楚的看到，ip数据包包头最小长度为20个字节。

#### 版本：

通信双方使用的IP协议版本必须一致。目前广泛使用的IP协议版本号为4（即IPv4）

#### 首部长度：

占4位，可表示的最大十进制数值是15。请注意，这个字段所表示数的单位是32位字长（1个32位字长是4字节），
因此，当IP的首部长度为1111时（即十进制的15），首部长度就达到60字节。当IP分组的首部长度不是4字节的整数倍时，
必须利用最后的填充字段加以填充。因此数据部分永远在4字节的整数倍开始，这样在实现IP协议时较为方便。
首部长度限制为60字节的缺点是有时可能不够用。但这样做是希望用户尽量减少开销。最常用的首部长度就是20字节
（即首部长度为0101），这时不使用任何选项。

#### 区分服务：

暂时没有发现有什么用


#### 总长度：

首部+数据  数据包最大长度为65535；

#### 标识：

占16位。IP软件在存储器中维持一个计数器，每产生一个数据报，计数器就加1，并将此值赋给标识字段。
但这个“标识”并不是序号，因为IP是无连接服务，数据报不存在按序接收的问题。当数据报由于长度超过网络的MTU而必须分片时，
这个标识字段的值就被复制到所有的数据报的标识字段中。相同的标识字段的值使分片后的各数据报片最后能正确地重装成为原来的数据报。


#### 标志：

三位，但是只有两位有用
- 标志字段中的最低位记为MF(MoreFragment)。MF=1即表示后面“还有分片”的数据报。MF=0表示这已是若干数据报片中的最后一个
- 标志字段中间的一位记为DF(Don’tFragment)，意思是“不能分片”。只有当DF=0时才允许分片。

#### 片偏移：

占13位。片偏移指出：较长的分组在分片后，某片在原分组中的相对位置。也就是说，相对用户数据字段的起点，该片从何处开始。
片偏移以8个字节为偏移单位。这就是说，除了最后一个分片，每个分片的长度一定是8字节（64位）的整数倍。


#### 生存时间：

占八位

#### 协议：

占8位，协议字段指出此数据报携带的数据是使用何种协议，以便使目的主机的IP层知道应将数据部分上交给哪个处理过程

#### 首部校验和：

占16位。这个字段只检验数据报的首部，但不包括数据部分。
这是因为数据报每经过一个路由器，路由器都要重新计算一下首部检验和（一些字段，如生存时间、标志、片偏移等都可能发生变化）。
不检验数据部分可减少计算的工作量


#### 源地址 32位

#### 目的地址 32位



